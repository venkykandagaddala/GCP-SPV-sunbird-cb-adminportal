<div class="container-balanced">


  <div class="profile-container container-balanced">
    <div class="profile-box">

      <form class="create-user-form ws-mat-accent-border max-wid" [formGroup]="createUserForm">
        <div class="input-column">
          <label class="heading">User details</label>

          <div class="input-wrapper margin-top-s">
            <label for="fname" class="margin-remove-bottom form-label required" aria-label="First name label">
              Full name
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="fname" matInput #fname formControlName="fname" pattern="[a-zA-Z ']*" placeholder="Type here"
                aria-label="First name input" class="form-input" autocomplete="off" maxlength="150" />
              <mat-error [hidden]="false" aria-label="First name Error|Explains name is required "
                *ngIf="createUserForm?.controls['fname']?.touched && createUserForm?.controls['fname'].errors?.required">
                Full name is mandatory
              </mat-error>
              <mat-error [hidden]="false" *ngIf="createUserForm?.controls['fname'].errors?.pattern"
                aria-label="First name Error|Name fields cannot contain numbers and special characters except">
                Name field can only contain letters, space and the character (')
              </mat-error>
            </mat-form-field>

            <!-- <label for="lname" class="margin-remove-bottom margin-top-xs form-label required"

              aria-label="Last name label">
              Last name
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="lname" matInput #lname formControlName="lname" placeholder="Type here"
                 aria-label="Last name input" class="form-input" pattern="[a-zA-Z ']*" autocomplete="off"
                maxlength="150" />
              <mat-error [hidden]="false"
                aria-label="Last name Error|Explains name is required "
                *ngIf="createUserForm?.controls['lname']?.touched && createUserForm?.controls['lname'].errors?.required">
                Last name is mandatory
              </mat-error>
              <mat-error [hidden]="false" *ngIf="createUserForm?.controls['lname'].errors?.pattern"
                aria-label="Last name Error|Name fields cannot contain numbers and special characters except ">
                Last name fields cannot contain numbers and special characters except '
              </mat-error>
            </mat-form-field> -->

            <label for="email" class="margin-remove-bottom margin-top-xs form-label required" aria-label="Email label">
              Email
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="email" matInput #email formControlName="email" placeholder="Type here" aria-label="Email input"
                class="form-input" autocomplete="off" maxlength="320"
                (input)="emailVerification($event.target.value)" />
              <mat-error [hidden]="false" aria-label="Email Error|Explains email is required "
                *ngIf="createUserForm?.controls['email']?.touched && createUserForm?.controls['email'].errors?.required">
                Email is mandatory
              </mat-error>
              <mat-error [hidden]="false" *ngIf="createUserForm?.controls['email'].errors?.invalid"
                aria-label="Email Error|Email fields not valid ">
                Email field is not valid
              </mat-error>
              <mat-error [hidden]="false"
                *ngIf="createUserForm?.controls['email']?.touched && createUserForm?.controls['email']?.errors?.pattern"
                aria-label="Email Error|Email fields not valid ">
                Please enter a valid email ID
              </mat-error>
              <div *ngIf="emailLengthVal" class="email-error">
                Max 64 characters before "&#64;" & 255 characters after "&#64;" are valid.
              </div>
            </mat-form-field>

            <!--Mobile number field-->
            <label for="mobileNumber" class="margin-remove-bottom margin-top-xs form-label"
              aria-label="Mobile Number label" [ngClass]="{ 'required': !disableRequired }">
              Mobile Number
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="mobileNumber" #mobile matInput type="text" maxlength="10" autocomplete="off"
                (keypress)="numericOnly($event)" (paste)="onPasteMobile($event)" placeholder="10-Digit Mobile Number"
                formControlName="mobileNumber" aria-label="Mobile Number input">
              <mat-error [hidden]="false"
                *ngIf="createUserForm?.controls['mobileNumber']?.touched && createUserForm?.controls['mobileNumber'].errors?.required"
                aria-label="Please enter your mobile number">Please enter your 10-digit Mobile Number
              </mat-error>
              <mat-error [hidden]="false" *ngIf="createUserForm?.controls['mobileNumber'].errors?.pattern"
                aria-label="Please enter a valid 10-digit Mobile Number">
                Please enter a valid 10-digit Mobile Number
              </mat-error>
            </mat-form-field>

            <label for="dept" class="margin-remove-bottom margin-top-xs form-label required" aria-label="Email label">
              Department
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="dept" matInput #dept formControlName="dept" placeholder="Type here" aria-label="Department"
                class="form-input" autocomplete="off" [readonly]="true" />
            </mat-form-field>
            <!-- <label for="deptType" class="margin-remove-bottom margin-top-xs form-label required"
               aria-label="Email label">
              Department type
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="deptType" matInput #deptType formControlName="deptType"
                placeholder="Type here"  aria-label="Department Type" class="form-input"
                autocomplete="off" />
            </mat-form-field> -->


            <label for="email" class="margin-remove-bottom margin-top-xs form-label required" aria-label="Roles label">
              Roles
            </label>

            <!-- <mat-form-field appearance="outline" class="margin-top-xs">
                  <mat-select [(value)]="selected" formControlName="role" placeholder="Roles">
                <mat-option multiple *ngFor="let role of roles" value='{{role}}' >
                  {{role}}</mat-option>
              </mat-select>
           <mat-select [(value)]="selected" formControlName="role" placeholder="Roles">
                <mat-option *ngFor="let role of roles; let i ===index" [value]="role">
                  <mat-checkbox value='{{role}}' [checked]="selectedMulti = i" (change)="onChange(role);selected = i">
                    {{role}}
                  </mat-checkbox>
                </mat-option>
              </mat-select>

               <mat-select placeholder="Roles" formControlName="role" class="select-back" #role multiple>
                <mat-option *ngFor="let role of roles" [value]="role">{{role}}</mat-option>
              </mat-select>


                  <mat-error *ngIf="createUserForm?.controls['email'].errors?.invalid" >Role mandatory
                  </mat-error>
                </mat-form-field>  -->


            <mat-selection-list id="role" formControlName="role" #role>
              <ng-container *ngFor="let role of roles">
                <mat-list-option (click)="modifyUserRoles(role)" [selected]="userRoles.has(role)" [value]="role">
                  {{role}}
                </mat-list-option>
              </ng-container>
            </mat-selection-list>

            <!-- <label for="dept" class="margin-remove-bottom margin-top-xs form-label required"
                aria-label="Email label">
              Department
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="dept" matInput #dept formControlName="dept" placeholder="Type here"
                 aria-label="Department" class="form-input" autocomplete="off" />
            </mat-form-field>
            <label for="deptType" class="margin-remove-bottom margin-top-xs form-label required"
                aria-label="Email label">
              Department type
            </label>
            <mat-form-field appearance="outline" class="margin-top-xs">
              <input id="deptType" matInput #deptType formControlName="deptType"
                placeholder="Type here"  aria-label="Department Type" class="form-input"
                autocomplete="off" />
            </mat-form-field> -->


            <!-- <div class="input-wrapper margin-top-s">
              <label for="department" class="margin-remove-bottom form-label required"
                aria-label="Department label" >
                Department
              </label>
              <mat-form-field appearance="outline" class="w-full margin-top-xs" *ngIf="receivedDept">
                <input id="department" class="form-input" [(ngModel)]="departmentName" type="text" matInput
                  placeholder="Type here" formControlName="department"
                  aria-label="Department input filed" readonly>
              </mat-form-field>
              <ng-multiselect-dropdown id="department" *ngIf="!receivedDept" [data]="departmentoptions"
                [settings]="dropdownSettings" (onSelect)="onItemSelect($event)" (onDeSelect)="onItemDeSelect()"
                formControlName="department">
              </ng-multiselect-dropdown>
            </div> -->

            <!-- <div class="input-wrapper margin-top-s margin-bottom-m"
              *ngIf="receivedDept || createUserForm.value.department">
              <label for="roles" class="margin-remove-bottom form-label required"
                aria-label="Roles label" >
                Role
              </label>
              <mat-selection-list id="roles" formControlName="roles" #roles>
                <mat-list-option *ngFor="let role of rolesList" (click)="modifyUserRoles(role)"
                  [selected]="userRoles.has(role.roleName)" [value]="role.roleName">
                  {{role.roleName}}
                </mat-list-option>
              </mat-selection-list>
            </div> -->

          </div>
        </div>


        <div class="flex flex-1 mt-5">
          <button mat-raised-button type="submit" *ngIf="!updateButton" (click)="onSubmit(createUserForm)"
            class="text-white btn-success" [disabled]="createUserForm?.invalid || disableCreateButton">
            <span class="text-white">
              Create user
            </span>
          </button>
          <button mat-raised-button type="submit" *ngIf="updateButton" (click)="onUpdate(createUserForm)"
            class="text-white btn-success" [disabled]="createUserForm?.invalid || disableCreateButton">
            <span class="text-white">
              Update user
            </span>
          </button>
          <button mat-raised-button type="button" class="flex-auto-display mar" (click)="navigateTo()">
            <span class="ws-mat-default-text">Cancel</span>
          </button>
        </div>
        <div *ngIf="displayLoader" class="mt-5 pr-4 flex items-center justify-center">
          <mat-spinner [diameter]="30"></mat-spinner>
        </div>

      </form>
    </div>
  </div>
</div>
<div class="flex gap-4">
  <div class="flex flex-col gap-1 w-full h-full">
    <div class="header">
      Configure Courses API
    </div>
    <div class="viaApi">

      <div class="linkLable required flex items-center">
        Link
        <mat-icon class="info-icon">info_outline</mat-icon>
      </div>

      <div class="flex gap-4 viaApiUrl">
        <form [formGroup]="viaApiFormGroup" class="flex w-full gap-0">
          <div class="apiTypeSelect">
            <mat-form-field appearance="outline" class="w-full">
              <mat-select class="event-select" formControlName="apiType" placeholder="Select">
                <ng-container *ngFor="let type of apiTypesList">
                  <mat-option [value]="type.value">{{type.type}}</mat-option>
                </ng-container>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="apiUrl w-full">
            <mat-form-field appearance="outline" class="w-full">
              <input type="text" matInput formControlName="apiUrl" placeholder="API Url">
            </mat-form-field>
          </div>
        </form>
      </div>

      <div class="vai-api-tabs mt-1">
        <ng-container *ngIf="!delayTabLoad">
          <mat-tab-group>
            <mat-tab label="Params">
              <ws-app-via-api-params-table [tableListFormGroup]="paramsFormGroup"
                [paramsType]="'params'"></ws-app-via-api-params-table>
            </mat-tab>
            <mat-tab label="Headers">
              <ws-app-via-api-params-table [tableListFormGroup]="headersFormGroup"
                [paramsType]="'headers'"></ws-app-via-api-params-table>
            </mat-tab>
            <mat-tab label="Body">
              <ws-app-via-api-params-table [tableListFormGroup]="bodyFormGroup"
                [paramsType]="'body'"></ws-app-via-api-params-table>
            </mat-tab>
            <ng-container *ngIf="servicesFormGroup?.controls?.isAuthenticated.value">
              <mat-tab label="Authentication">
                <ws-app-via-api-params-table [tableListFormGroup]="authenticationFormGroup"
                  [paramsType]="'authentication'"></ws-app-via-api-params-table>
              </mat-tab>
            </ng-container>
          </mat-tab-group>
        </ng-container>
      </div>

      <form [formGroup]="servicesFormGroup">
        <div class="flex flex-column gap-14 mt-14">
          <div class="flex flex-column gap-1 w-full">
            <div class="flex items-center gap-1 required">
              <span class="lable">Service Name</span>
            </div>
            <mat-form-field class="w-full services-input-form">
              <input formControlName="serviceName" matInput placeholder="Type here">
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceName', 'required')">
                Service Name is mandatory
              </mat-error>
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceName', 'pattern')">
                Only ( a-z/A-Z/0-9 . - _ $ / : [ ]' !) characters are supported
              </mat-error>
              <mat-hint class="w-full flex justify-between items-center">
                <span class="input-note">Only ( a-z/A-Z/0-9 . - _ $ / : [ ]' !) characters are supported</span>
              </mat-hint>
            </mat-form-field>
          </div>

          <div class="flex flex-column gap-1 w-full"
            [ngClass]="{'disableControl': providerDetails?.serviceRegistryDetails?.contentApisId}">
            <div class="flex items-center gap-1 required">
              <span class="lable">Service Code</span>
            </div>
            <mat-form-field class="w-full services-input-form">
              <input class="serviceCode" formControlName="serviceCode" matInput placeholder="Type here" maxlength="6">
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceCode', 'required')">
                Service Code is mandatory
              </mat-error>
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceCode', 'pattern')">
                Only ( a-z/A-Z/0-9) characters are supported
              </mat-error>
              <mat-hint class="w-full flex justify-between items-center">
                <span class="input-note">Only ( a-z/A-Z/0-9) characters are supported</span>
              </mat-hint>
            </mat-form-field>
          </div>

          <div class="flex flex-column gap-1 w-full">
            <div class="flex items-center gap-1 required">
              <span class="lable">Service Description</span>
              <mat-icon class="info-icon"
                matTooltip="We recomment you to give description in 300-500 characters">info_outline</mat-icon>
            </div>
            <mat-form-field class="w-full description">
              <textarea matInput rows="6" formControlName="serviceDescription" maxlength="500"
                placeholder="Type the decription in fewer than 500 characters" i18n-placeholder></textarea>
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceDescription', 'required')">
                Description is mandatory
              </mat-error>
              <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                *ngIf="getControlValidation('serviceDescription', 'pattern')">
                Only ( a-z/A-Z/0-9 . - _ $ / : [ ] ' , !) characters are supported
              </mat-error>
              <mat-hint class="w-full flex justify-between items-center">
                <span class="input-note">Only ( a-z/A-Z/0-9 . - _ $ / : [ ] ' , !) characters are supported</span>
                <span class="input-note">{{getTextLength('serviceDescription')}}/500</span>
              </mat-hint>
            </mat-form-field>
          </div>

          <div class="flex flex-col gap-4">
            <div class="flex justify-between">
              <mat-slide-toggle formControlName="isAuthenticated" (change)="authenticationToggleChange()">
                <span class="lable">Has Authentication</span>
              </mat-slide-toggle>
              <ng-container *ngIf="servicesFormGroup?.controls?.isAuthenticated.value">
                <mat-slide-toggle [ngClass]="{'hideElement': !servicesFormGroup?.controls?.isAuthenticated.value}"
                  formControlName="strictCache" (change)="onToggleChange()">
                  <span class="lable">Has Authentication Expiry</span>
                </mat-slide-toggle>
              </ng-container>
            </div>
            <ng-container *ngIf="servicesFormGroup?.controls?.strictCache.value">
              <div class="flex flex-column gap-1 w-full mb-6">
                <div class="flex items-center gap-1 required">
                  <span class="lable">Expirey time in minutes</span>
                </div>
                <mat-form-field class="w-full description">
                  <input matInput formControlName="strictCacheTimeInMinutes" type="number" placeholder="minutes"
                    i18n-placeholder>
                  <mat-error [hidden]="false" aria-label="Event title Error|Explains event title is required "
                    *ngIf="getControlValidation('serviceDescription', 'required')">
                    Time is mandatory
                  </mat-error>
                </mat-form-field>
              </div>
            </ng-container>
          </div>
        </div>
      </form>

    </div>
  </div>

  <ng-container *ngIf="transformationType !== 'certificateTemplateUrl'">
    <div class="flex w-full flex-col gap-1 h-full">
      <div>
        <span class="header">Transform {{transformationType === 'trasformContentJson' ? 'Content' : 'Progress'}}</span>
      </div>
      <div class="flex flex-col gap-4 transformation-box"
        [ngClass]="{'transformation-required': (!transformationsUpdated && executed)}">
        <!-- <mat-radio-group [(ngModel)]="transforamtionType" class="flex gap-4 mb-4">
          <mat-radio-button value="viaForm">Map Form</mat-radio-button>
          <mat-radio-button value="viaSpec">Spec</mat-radio-button>
        </mat-radio-group> -->
        <ng-container *ngIf="transforamtionType === 'viaForm'; else specForm">
          <form [formGroup]="transforamtionForm">
            <div class="flex flex-col gap-2">
              <ng-container *ngFor="let transFormControl of transFormContentKeysAndControls">
                <div class="flex gap-4 items-center">
                  <mat-form-field appearance="outline" class="w-full"
                    [matTooltip]="availableHeadrsList?.length ? null : 'Please upload file'">
                    <mat-select formControlName="{{transFormControl?.controlName}}" (selectionChange)="onSelectChange()"
                      [placeholder]=transFormControl?.lable>
                      <ng-container *ngFor="let header of availableHeadrsList">
                        <mat-option [value]="header">
                          {{header}}
                        </mat-option>
                      </ng-container>
                      <ng-container *ngIf="transforamtionForm.value[transFormControl.controlName]">
                        <mat-option [value]="transforamtionForm.value[transFormControl.controlName]">
                          {{transforamtionForm.value[transFormControl.controlName]}}
                        </mat-option>
                      </ng-container>
                    </mat-select>
                  </mat-form-field>
                  <span class="colun">:</span>
                  <span class="lable">{{transFormControl?.lable}}</span>
                </div>
              </ng-container>
            </div>
          </form>
        </ng-container>
        <ng-template #specForm>
          <json-editor [options]="editorOptions" [formControl]="transformationSpecForm" class="transformationEditor"
            [ngClass]="{'has-error': transformationSpecForm.invalid && transformationSpecForm.touched}">
          </json-editor>
        </ng-template>
        <div class="flex w-full justify-end mt-4">
          <button mat-button class="save-properties" (click)="upDateTransforamtionDetails()">
            {{getUpdateBtnText}}</button>
        </div>
      </div>
    </div>
  </ng-container>
</div>
<div class="flex justify-center items-center mt-6">
  <button mat-button class="fetchData" (click)="configure()">Configure</button>
</div>